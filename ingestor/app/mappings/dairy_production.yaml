dataset: dairy_production
granularity: daily

columns:
  "Date": production_date
  "Day production/cow (kg)": day_production_per_cow_kg
  "Nr. animals": number_of_animals
  "Average lactation days": average_lactation_days
  "Fed per cow (kg) - Total": fed_per_cow_total_kg
  "Fed per cow (kg) - Water": fed_per_cow_water_kg
  "Feed efficiency": feed_efficiency
  "Rumination minutes": rumination_minutes

coercions:
  production_date: date
  day_production_per_cow_kg: float
  number_of_animals: int
  average_lactation_days: int
  fed_per_cow_total_kg: float
  fed_per_cow_water_kg: float
  feed_efficiency: float
  rumination_minutes: int

primary_key:
  - production_date

# Validation Rules (Phase 1 Refactoring)
validation_rules:
  schema:
    required:
      - production_date
      - number_of_animals
  
  constraints:
    day_production_per_cow_kg:
      min: 0
      max: 100
    number_of_animals:
      min: 1
      max: 10000
    average_lactation_days:
      min: 0
      max: 1000
    fed_per_cow_total_kg:
      min: 0
      max: 200
    fed_per_cow_water_kg:
      min: 0
      max: 100
    feed_efficiency:
      min: 0
      max: 10
    rumination_minutes:
      min: 0
      max: 1440

# Conflict Resolution Strategy
conflict_resolution:
  strategy: update
  on_columns:
    - production_date
  update_columns:
    - day_production_per_cow_kg
    - number_of_animals
    - average_lactation_days
    - fed_per_cow_total_kg
    - fed_per_cow_water_kg
    - feed_efficiency
    - rumination_minutes

# Target Configuration
target_table: dairy_production
staging_table: staging_dairy_production